@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
    :root {
        --background: 0 0% 100%;
        --foreground: 224 71% 4%;
        --card: 0 0% 100%;
        --card-foreground: 224 71% 4%;
        --popover: 0 0% 100%;
        --popover-foreground: 224 71% 4%;
        --primary: 158 64% 52%;
        --primary-foreground: 0 0% 100%;
        --secondary: 220 14% 96%;
        --secondary-foreground: 220 9% 46%;
        --muted: 220 14% 96%;
        --muted-foreground: 220 9% 46%;
        --accent: 220 14% 96%;
        --accent-foreground: 224 71% 4%;
        --destructive: 0 84% 60%;
        --destructive-foreground: 0 0% 100%;
        --border: 220 13% 91%;
        --input: 220 13% 91%;
        --ring: 158 64% 52%;
        --radius: 0.75rem;
    }

    .dark {
        --background: 224 71% 4%;
        --foreground: 213 31% 91%;
        --card: 224 71% 7%;
        --card-foreground: 213 31% 91%;
        --popover: 224 71% 7%;
        --popover-foreground: 213 31% 91%;
        --primary: 158 64% 52%;
        --primary-foreground: 0 0% 100%;
        --secondary: 215 28% 17%;
        --secondary-foreground: 213 31% 91%;
        --muted: 215 28% 17%;
        --muted-foreground: 215 20% 65%;
        --accent: 215 28% 17%;
        --accent-foreground: 213 31% 91%;
        --destructive: 0 62% 50%;
        --destructive-foreground: 0 0% 100%;
        --border: 215 28% 17%;
        --input: 215 28% 17%;
        --ring: 158 64% 52%;
    }

    /* Pitch Black OLED Theme - Pure black for battery saving */
    .pitch-black {
        --background: 0 0% 0%;
        --foreground: 0 0% 95%;
        --card: 0 0% 3%;
        --card-foreground: 0 0% 95%;
        --popover: 0 0% 3%;
        --popover-foreground: 0 0% 95%;
        --primary: 158 64% 52%;
        --primary-foreground: 0 0% 100%;
        --secondary: 0 0% 8%;
        --secondary-foreground: 0 0% 95%;
        --muted: 0 0% 8%;
        --muted-foreground: 0 0% 60%;
        --accent: 0 0% 8%;
        --accent-foreground: 0 0% 95%;
        --destructive: 0 62% 50%;
        --destructive-foreground: 0 0% 100%;
        --border: 0 0% 12%;
        --input: 0 0% 12%;
        --ring: 158 64% 52%;
    }
}

@layer base {
    * {
        @apply border-border;
    }

    :root {
        --text-scale: 1;
        --zoom-scale: 1;
    }

    html {
        /* Apply text scale to root so all rem-based sizes scale */
        font-size: calc(16px * var(--text-scale));
    }

    body {
        @apply bg-background text-foreground antialiased;
        min-height: 100dvh;
        min-height: 100vh;
        /* fallback */
        /* Use transform for zoom - more compatible and predictable */
        transform: scale(var(--zoom-scale));
        transform-origin: top left;
        width: calc(100% / var(--zoom-scale));
        min-height: calc(100dvh / var(--zoom-scale));
    }

    /* Reduced motion preference */
    .reduce-motion,
    .reduce-motion * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }

    ::-webkit-scrollbar-track {
        @apply bg-transparent;
    }

    ::-webkit-scrollbar-thumb {
        @apply bg-muted-foreground/20 rounded-full;
    }

    ::-webkit-scrollbar-thumb:hover {
        @apply bg-muted-foreground/40;
    }
}

@layer components {

    /* Post card hover effect */
    .post-card {
        @apply transition-colors duration-200 hover:bg-accent/50;
    }

    /* Action button styles */
    .action-button {
        @apply p-2 rounded-full transition-all duration-200;
    }

    .action-button-like {
        @apply hover:bg-red-500/10 hover:text-red-500;
    }

    .action-button-like.liked {
        @apply text-red-500;
    }

    .action-button-reply {
        @apply hover:bg-primary/10 hover:text-primary;
    }

    .action-button-repost {
        @apply hover:bg-green-500/10 hover:text-green-500;
    }

    .action-button-repost.reposted {
        @apply text-green-500;
    }

    .action-button-bookmark {
        @apply hover:bg-primary/10 hover:text-primary;
    }

    .action-button-bookmark.bookmarked {
        @apply text-primary;
    }

    /* Loading skeleton */
    .skeleton {
        @apply relative overflow-hidden bg-muted;
    }

    .skeleton::after {
        @apply absolute inset-0 -translate-x-full;
        background: linear-gradient(90deg,
                transparent,
                hsl(var(--muted-foreground) / 0.1),
                transparent);
        animation: shimmer 2s infinite;
        content: "";
    }

    /* Feed layout */
    .feed-container {
        @apply max-w-[600px] mx-auto;
    }

    /* Mobile bottom nav */
    .mobile-nav {
        @apply fixed bottom-0 left-0 right-0 bg-background border-t border-border;
        @apply flex justify-around items-center h-14 px-4;
        @apply md:hidden;
        padding-bottom: env(safe-area-inset-bottom);
    }

    /* Composer */
    .composer-textarea {
        @apply w-full bg-transparent resize-none border-0 focus:ring-0;
        @apply text-lg placeholder:text-muted-foreground;
        @apply min-h-[80px];
    }

    /* Post type badge */
    .post-type-badge {
        @apply inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium;
    }

    .post-type-workout {
        @apply bg-blue-500/10 text-blue-500;
    }

    .post-type-progress {
        @apply bg-purple-500/10 text-purple-500;
    }

    .post-type-pr {
        @apply bg-amber-500/10 text-amber-500;
    }

    .post-type-meal {
        @apply bg-green-500/10 text-green-500;
    }

    .post-type-note {
        @apply bg-muted text-muted-foreground;
    }

    /* Profile header */
    .profile-banner {
        @apply h-32 sm:h-48 bg-gradient-to-r from-primary/20 to-primary/40;
    }

    /* Floating action button */
    .fab {
        @apply fixed bottom-20 right-4 w-14 h-14 rounded-full;
        @apply bg-primary text-primary-foreground shadow-lg;
        @apply flex items-center justify-center;
        @apply transition-transform hover:scale-110 active:scale-95;
        @apply md:hidden;
    }
}

@layer utilities {

    /* Hide scrollbar but keep functionality */
    .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }

    .scrollbar-hide::-webkit-scrollbar {
        display: none;
    }

    /* Line clamp */
    .line-clamp-1 {
        display: -webkit-box;
        -webkit-line-clamp: 1;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .line-clamp-3 {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
}